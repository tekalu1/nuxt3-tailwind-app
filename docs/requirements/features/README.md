# 機能要件ガイド

画面・機能単位の要件定義ドキュメントの作成方法について説明します。

---

## 機能要件定義書とは

機能要件定義書は、各画面・機能が「何を実現すべきか」をユーザー視点で定義するドキュメントです。

### 目的

1. **実装前の要件明確化**: 何を作るべきかを明確にする
2. **テストシナリオの基礎**: テスト設計の入力となる
3. **トレーサビリティの確保**: 要件 → テスト → 実装 の追跡を可能にする

### システム要件との違い

| 項目 | 機能要件 (features/) | システム要件 (system/) |
|------|---------------------|----------------------|
| 形式 | Markdown | TypeScript型定義 |
| 視点 | ユーザー視点 | 技術視点 |
| 粒度 | 画面・機能単位 | データ構造単位 |
| 用途 | テストシナリオ作成 | 実装時の型チェック |

---

## ドキュメント構成

```
features/
├── README.md                    # 本ドキュメント
├── _template.md                 # テンプレート
├── pages/                       # ページ単位の要件
│   ├── user-management.md      # ユーザー管理画面
│   ├── product-list.md         # 商品一覧画面
│   └── order-history.md        # 注文履歴画面
├── features/                    # 機能単位の要件
│   ├── authentication.md       # 認証機能
│   ├── search.md               # 検索機能
│   ├── cart.md                 # カート機能
│   └── checkout.md             # チェックアウト機能
└── common/                      # 共通機能の要件
    ├── form-validation.md      # フォームバリデーション
    ├── notification.md         # 通知機能
    ├── pagination.md           # ページネーション
    └── modal.md                # モーダル
```

### カテゴリの分類基準

| カテゴリ | 説明 | 例 |
|---------|------|-----|
| pages/ | ページ単位の要件（Nuxt3のpages/と対応） | ユーザー管理、商品一覧 |
| features/ | 特定機能の要件（複数ページで使用可能） | 認証、検索、カート |
| common/ | 複数ページで共通のUI機能 | バリデーション、通知、モーダル |

---

## 機能要件定義書の構成

各ドキュメントは以下の構成で作成します。

### 1. 概要

画面の目的と対象ユーザーを記載します。

```markdown
## 1. 概要

### 目的
ユーザー情報の一覧表示、検索、編集機能を提供する。

### 対象ユーザー
- システム管理者
- 運用担当者
```

### 2. 機能一覧

画面が提供する機能を一覧化します。各機能にはIDを付与します。

```markdown
## 2. 機能一覧

| ID | 機能名 | 説明 | 優先度 |
|----|--------|------|--------|
| FR-USER-001 | ユーザー一覧表示 | 登録済みユーザーを一覧表示できる | 必須 |
| FR-USER-002 | ユーザー検索 | 名前やメールで検索できる | 必須 |
| FR-USER-003 | ユーザー編集 | ユーザー情報を編集できる | 必須 |
```

### 3. 画面構成

画面のレイアウトと主要コンポーネントを説明します。

```markdown
## 3. 画面構成

### レイアウト
- 上部: 検索バー
- 中央: ユーザーテーブル
- 下部: ページネーション

### 主要コンポーネント
- SearchBar: 検索入力フォーム
- UserTable: ユーザー一覧テーブル
- Pagination: ページ切り替えコントロール
```

### 4. 操作フロー

ユーザーの典型的な操作手順を記載します。

```markdown
## 4. 操作フロー

### 基本フロー: ユーザーの検索と編集

1. ユーザーが検索バーにキーワードを入力
2. 検索ボタンをクリック（またはEnter）
3. 検索結果がテーブルに表示される
4. 編集したい行の「編集」ボタンをクリック
5. 編集モーダルが開く
6. 情報を編集して「保存」をクリック
7. 成功メッセージが表示され、一覧が更新される
```

### 5. 入出力仕様

入力項目、バリデーション、出力を定義します。

```markdown
## 5. 入出力仕様

### 入力
| 項目 | 型 | 必須 | バリデーション |
|------|-----|------|---------------|
| 名前 | string | Yes | 1-100文字 |
| メール | string | Yes | メール形式 |
| 役割 | select | Yes | admin/member/guest |

### 出力
- 保存成功時: 成功トースト表示
- 保存失敗時: エラートースト表示
```

### 6. 非機能要件

パフォーマンス、セキュリティなどの非機能要件を記載します。

```markdown
## 6. 非機能要件

### パフォーマンス
- 一覧表示は1秒以内に完了すること
- 検索結果は500ms以内に表示されること

### セキュリティ
- 管理者権限を持つユーザーのみアクセス可能
```

### 7. テストシナリオへのリンク

関連するテストシナリオへの参照を記載します。

```markdown
## 7. テストシナリオへのリンク

- [E2E: ユーザー管理](../../test/e2e/scenarios/user-management.md)
- [統合: ユーザーAPI](../../test/integration/scenarios/user-api.md)
```

---

## ID体系

### フォーマット

```
FR-{画面コード}-{連番}
```

### 画面コード一覧

| 画面/機能 | コード | 例 |
|----------|--------|-----|
| ホーム | HOME | FR-HOME-001 |
| ユーザー管理 | USER | FR-USER-001 |
| 商品一覧 | PROD | FR-PROD-001 |
| 商品詳細 | PDET | FR-PDET-001 |
| カート | CART | FR-CART-001 |
| 注文 | ORDER | FR-ORDER-001 |
| 設定 | SET | FR-SET-001 |
| ダッシュボード | DASH | FR-DASH-001 |
| 認証 | AUTH | FR-AUTH-001 |
| 検索 | SRCH | FR-SRCH-001 |
| 通知 | NOTIF | FR-NOTIF-001 |
| フォーム共通 | FORM | FR-FORM-001 |

---

## 作成手順

### 1. テンプレートをコピー

```bash
# ページの場合
cp docs/requirements/features/_template.md docs/requirements/features/pages/{ページ名}.md

# 機能の場合
cp docs/requirements/features/_template.md docs/requirements/features/features/{機能名}.md

# 共通機能の場合
cp docs/requirements/features/_template.md docs/requirements/features/common/{機能名}.md
```

### 2. 各セクションを記入

上記の構成に従って各セクションを埋めます。

### 3. IDを付与

機能一覧の各項目に一意のIDを付与します。

### 4. テストシナリオを作成

機能要件に基づいて、テストシナリオを作成します。
→ [テストプロセス](../../test/README.md) を参照

### 5. 相互リンクを追加

機能要件書とテストシナリオ間の相互リンクを追加します。

---

## 関連ドキュメント

- [要件定義ガイド](../README.md)
- [テストプロセス](../../test/README.md)
- [開発ガイド](../../development/development-guide.md)
